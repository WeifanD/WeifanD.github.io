by_speaker_scene <- lines %>%
count(scene, character)
library(reshape2)
speaker_scene_matrix <- by_speaker_scene %>%
acast(character ~ scene, fun.aggregate = length)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
h <- hclust(dist(norm, method = "manhattan"))
plot(h)
key_characters <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
mutate(character = str_replace(character,"\\(.+", ""),
character = str_replace(character," ", "")) %>%
group_by(character) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
head(20)
lines <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
inner_join(key_characters) %>%
group_by(scene, line = cumsum(!is.na(character))) %>%
summarize(character = character[1], dialogue = str_c(dialogue, collapse = " ")) %>%
mutate(character = str_replace(character,"\\(.+", "")) %>%
filter(!is.na(character), !character %in% c(''))
by_speaker_scene <- lines %>%
count(scene, character)
library(reshape2)
speaker_scene_matrix <- by_speaker_scene %>%
acast(character ~ scene, fun.aggregate = length)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
h <- hclust(dist(norm, method = "manhattan"))
plot(h)
key_characters <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
mutate(character = str_replace(character,"\\(.+", ""),
character = str_replace(character," ", "")) %>%
group_by(character) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
head(30)
lines <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
inner_join(key_characters) %>%
group_by(scene, line = cumsum(!is.na(character))) %>%
summarize(character = character[1], dialogue = str_c(dialogue, collapse = " ")) %>%
mutate(character = str_replace(character,"\\(.+", "")) %>%
filter(!is.na(character), !character %in% c(''))
by_speaker_scene <- lines %>%
count(scene, character)
library(reshape2)
speaker_scene_matrix <- by_speaker_scene %>%
acast(character ~ scene, fun.aggregate = length)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
h <- hclust(dist(norm, method = "manhattan"))
plot(h)
key_characters <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
mutate(character = str_replace(character,"\\(.+", ""),
character = str_replace(character," ", "")) %>%
group_by(character) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
head(30)
lines <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
inner_join(key_characters) %>%
group_by(scene, line = cumsum(!is.na(character))) %>%
summarize(character = character[1], dialogue = str_c(dialogue, collapse = " ")) %>%
mutate(character = str_replace(character,"\\(.+", "")) %>%
filter(!is.na(character), !character %in% c(''))
by_speaker_scene <- lines %>%
count(scene, character)
speaker_scene_matrix <- by_speaker_scene %>%
acast(character ~ scene, fun.aggregate = length)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
h <- hclust(dist(norm, method = "manhattan"))
plot(h)
ordering <- h$labels[h$order]
ordering
key_characters <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
mutate(character = str_replace(character,"\\(.+", ""),
character = str_replace(character," ", "")) %>%
group_by(character) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
head(30)
lines <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
inner_join(key_characters) %>%
group_by(scene, line = cumsum(!is.na(character))) %>%
summarize(character = character[1], dialogue = str_c(dialogue, collapse = " ")) %>%
mutate(character = str_replace(character,"\\(.+", "")) %>%
filter(!is.na(character), !character %in% c(''))
by_speaker_scene <- lines %>%
count(scene, character)
speaker_scene_matrix <- by_speaker_scene %>%
acast(character ~ scene, fun.aggregate = length)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
h <- hclust(dist(norm, method = "manhattan"))
plot(h)
scenes <- by_speaker_scene %>%
filter(n() > 1) %>%        # scenes with > 1 character
ungroup() %>%
mutate(scene = as.numeric(factor(scene)),
character = factor(character, levels = ordering))
ggplot(scenes, aes(scene, character)) +
geom_point() +
geom_path(aes(group = scene))
key_characters <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
mutate(character = str_replace(character,"\\(.+", ""),
character = str_replace(character," ", "")) %>%
group_by(character) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
head(40)
lines <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
inner_join(key_characters) %>%
group_by(scene, line = cumsum(!is.na(character))) %>%
summarize(character = character[1], dialogue = str_c(dialogue, collapse = " ")) %>%
mutate(character = str_replace(character,"\\(.+", "")) %>%
filter(!is.na(character), !character %in% c(''))
by_speaker_scene <- lines %>%
count(scene, character)
speaker_scene_matrix <- by_speaker_scene %>%
acast(character ~ scene, fun.aggregate = length)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
h <- hclust(dist(norm, method = "manhattan"))
plot(h)
key_characters <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
mutate(character = str_replace(character,"\\(.+", ""),
character = str_replace(character," ", "")) %>%
group_by(character) %>%
summarise(n = n()) %>%
arrange(desc(n))
View(key_characters)
key_characters <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
mutate(character = str_replace(character,"\\(.+", ""),
character = str_replace(character," ", "")) %>%
group_by(character) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
filter(n>50)
lines <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
inner_join(key_characters) %>%
group_by(scene, line = cumsum(!is.na(character))) %>%
summarize(character = character[1], dialogue = str_c(dialogue, collapse = " ")) %>%
mutate(character = str_replace(character,"\\(.+", "")) %>%
filter(!is.na(character), !character %in% c(''))
by_speaker_scene <- lines %>%
count(scene, character)
speaker_scene_matrix <- by_speaker_scene %>%
acast(character ~ scene, fun.aggregate = length)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
h <- hclust(dist(norm, method = "manhattan"))
plot(h)
key_characters <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
mutate(character = str_replace(character,"\\(.+", ""),
character = str_replace(character," ", "")) %>%
group_by(character) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
filter(n>10)
lines <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
inner_join(key_characters) %>%
group_by(scene, line = cumsum(!is.na(character))) %>%
summarize(character = character[1], dialogue = str_c(dialogue, collapse = " ")) %>%
mutate(character = str_replace(character,"\\(.+", "")) %>%
filter(!is.na(character), !character %in% c(''))
by_speaker_scene <- lines %>%
count(scene, character)
speaker_scene_matrix <- by_speaker_scene %>%
acast(character ~ scene, fun.aggregate = length)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
h <- hclust(dist(norm, method = "manhattan"))
plot(h)
key_characters <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
mutate(character = str_replace(character,"\\(.+", ""),
character = str_replace(character," ", "")) %>%
group_by(character) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
filter(n>20)
lines <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
inner_join(key_characters) %>%
group_by(scene, line = cumsum(!is.na(character))) %>%
summarize(character = character[1], dialogue = str_c(dialogue, collapse = " ")) %>%
mutate(character = str_replace(character,"\\(.+", "")) %>%
filter(!is.na(character), !character %in% c(''))
by_speaker_scene <- lines %>%
count(scene, character)
speaker_scene_matrix <- by_speaker_scene %>%
acast(character ~ scene, fun.aggregate = length)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
h <- hclust(dist(norm, method = "manhattan"))
plot(h)
key_characters <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
mutate(character = str_replace(character,"\\(.+", ""),
character = str_replace(character," ", "")) %>%
group_by(character) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
filter(n>20)
lines <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
inner_join(key_characters) %>%
group_by(scene, line = cumsum(!is.na(character))) %>%
summarize(character = character[1], dialogue = str_c(dialogue, collapse = " ")) %>%
mutate(character = str_replace(character,"\\(.+", "")) %>%
filter(!is.na(character), !character %in% c(''))
by_speaker_scene <- lines %>%
count(scene, character)
speaker_scene_matrix <- by_speaker_scene %>%
acast(character ~ scene, fun.aggregate = length)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
h <- hclust(dist(norm, method = "manhattan"))
plot(h, hang = -1))
key_characters <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
mutate(character = str_replace(character,"\\(.+", ""),
character = str_replace(character," ", "")) %>%
group_by(character) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
filter(n>20)
lines <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
inner_join(key_characters) %>%
group_by(scene, line = cumsum(!is.na(character))) %>%
summarize(character = character[1], dialogue = str_c(dialogue, collapse = " ")) %>%
mutate(character = str_replace(character,"\\(.+", "")) %>%
filter(!is.na(character), !character %in% c(''))
by_speaker_scene <- lines %>%
count(scene, character)
speaker_scene_matrix <- by_speaker_scene %>%
acast(character ~ scene, fun.aggregate = length)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
h <- hclust(dist(norm, method = "manhattan"))
plot(h, hang = -1)
install.packages("ape")
key_characters <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
mutate(character = str_replace(character,"\\(.+", ""),
character = str_replace(character," ", "")) %>%
group_by(character) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
filter(n>20)
lines <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
inner_join(key_characters) %>%
group_by(scene, line = cumsum(!is.na(character))) %>%
summarize(character = character[1], dialogue = str_c(dialogue, collapse = " ")) %>%
mutate(character = str_replace(character,"\\(.+", "")) %>%
filter(!is.na(character), !character %in% c(''))
by_speaker_scene <- lines %>%
count(scene, character)
speaker_scene_matrix <- by_speaker_scene %>%
acast(character ~ scene, fun.aggregate = length)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
h <- hclust(dist(norm, method = "manhattan"))
# load package ape; remember to install it: install.packages('ape')
library(ape)
# plot basic tree
plot(as.phylo(h), cex = 0.9, label.offset = 1)
key_characters <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
mutate(character = str_replace(character,"\\(.+", ""),
character = str_replace(character," ", "")) %>%
group_by(character) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
filter(n>20)
lines <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
inner_join(key_characters) %>%
group_by(scene, line = cumsum(!is.na(character))) %>%
summarize(character = character[1], dialogue = str_c(dialogue, collapse = " ")) %>%
mutate(character = str_replace(character,"\\(.+", "")) %>%
filter(!is.na(character), !character %in% c(''))
by_speaker_scene <- lines %>%
count(scene, character)
speaker_scene_matrix <- by_speaker_scene %>%
acast(character ~ scene, fun.aggregate = length)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
h <- hclust(dist(norm, method = "manhattan"))
plot(h)
key_characters <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
mutate(character = str_replace(character,"\\(.+", ""),
character = str_replace(character," ", "")) %>%
group_by(character) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
filter(n>30)
lines <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
inner_join(key_characters) %>%
group_by(scene, line = cumsum(!is.na(character))) %>%
summarize(character = character[1], dialogue = str_c(dialogue, collapse = " ")) %>%
mutate(character = str_replace(character,"\\(.+", "")) %>%
filter(!is.na(character), !character %in% c(''))
by_speaker_scene <- lines %>%
count(scene, character)
speaker_scene_matrix <- by_speaker_scene %>%
acast(character ~ scene, fun.aggregate = length)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
h <- hclust(dist(norm, method = "manhattan"))
plot(h)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
h <- hclust(dist(norm, method = "manhattan"))
plot(h)
key_characters <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
mutate(character = str_replace(character,"\\(.+", ""),
character = str_replace(character," ", "")) %>%
group_by(character) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
filter(n>25)
lines <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
inner_join(key_characters) %>%
group_by(scene, line = cumsum(!is.na(character))) %>%
summarize(character = character[1], dialogue = str_c(dialogue, collapse = " ")) %>%
mutate(character = str_replace(character,"\\(.+", "")) %>%
filter(!is.na(character), !character %in% c(''))
by_speaker_scene <- lines %>%
count(scene, character)
speaker_scene_matrix <- by_speaker_scene %>%
acast(character ~ scene, fun.aggregate = length)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
h <- hclust(dist(norm, method = "manhattan"))
plot(h)
key_characters <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
mutate(character = str_replace(character,"\\(.+", ""),
character = str_replace(character," ", "")) %>%
group_by(character) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
filter(n>30)
lines <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
inner_join(key_characters) %>%
group_by(scene, line = cumsum(!is.na(character))) %>%
summarize(character = character[1], dialogue = str_c(dialogue, collapse = " ")) %>%
mutate(character = str_replace(character,"\\(.+", "")) %>%
filter(!is.na(character), !character %in% c(''))
by_speaker_scene <- lines %>%
count(scene, character)
speaker_scene_matrix <- by_speaker_scene %>%
acast(character ~ scene, fun.aggregate = length)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
h <- hclust(dist(norm, method = "manhattan"))
plot(h)
non_airport_scenes <- speaker_scene_matrix[, colSums(speaker_scene_matrix) < 10]
cooccur <- non_airport_scenes %*% t(non_airport_scenes)
heatmap(cooccur)
View(speaker_scene_matrix)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
hc <- hclust(dist(norm, method = "manhattan"))
hcd = as.dendrogram(hc)
# vector of colors labelColors = c('red', 'blue', 'darkgreen', 'darkgrey',
# 'purple')
labelColors = c("#CDB380", "#036564", "#EB6841", "#EDC951")
# cut dendrogram in 4 clusters
clusMember = cutree(hc, 4)
# function to get color labels
colLab <- function(n) {
if (is.leaf(n)) {
a <- attributes(n)
labCol <- labelColors[clusMember[which(names(clusMember) == a$label)]]
attr(n, "nodePar") <- c(a$nodePar, lab.col = labCol)
}
n
}
# using dendrapply
clusDendro = dendrapply(hcd, colLab)
# make plot
plot(clusDendro, main = "Cool Dendrogram", type = "triangle")
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
hc <- hclust(dist(norm, method = "manhattan"))
plot(hc)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
hc <- hclust(dist(norm))
plot(hc)
key_characters <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
mutate(character = str_replace(character,"\\(.+", ""),
character = str_replace(character," ", "")) %>%
group_by(character) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
filter(n>25)
lines <- dialogue %>%
filter(!is_scene, !form %in% c('Original Airdate','Written by','Directed by','Others','MVO')) %>%
rename(character = form, dialogue = content) %>%
inner_join(key_characters) %>%
group_by(scene, line = cumsum(!is.na(character))) %>%
summarize(character = character[1], dialogue = str_c(dialogue, collapse = " ")) %>%
mutate(character = str_replace(character,"\\(.+", "")) %>%
filter(!is.na(character), !character %in% c(''))
by_speaker_scene <- lines %>%
count(scene, character)
speaker_scene_matrix <- by_speaker_scene %>%
acast(character ~ scene, fun.aggregate = length)
dim(speaker_scene_matrix)
norm <- speaker_scene_matrix / rowSums(speaker_scene_matrix)
hc <- hclust(dist(norm, method = "manhattan"))
plot(hc)
View(speaker_scene_matrix)
non_airport_scenes <- speaker_scene_matrix[, colSums(speaker_scene_matrix) < 5]
cooccur <- non_airport_scenes %*% t(non_airport_scenes)
heatmap(cooccur)
non_airport_scenes <- speaker_scene_matrix
cooccur <- non_airport_scenes %*% t(non_airport_scenes)
heatmap(cooccur)
install.packages("igraph")
library(igraph)
g <- graph.adjacency(cooccur, weighted = TRUE, mode = "undirected", diag = FALSE)
plot(g, edge.width = E(g)$weight)
View(cooccur)
colSums(speaker_scene_matrix)
non_airport_scenes <- speaker_scene_matrix[, colSums(speaker_scene_matrix)<15]
cooccur <- non_airport_scenes %*% t(non_airport_scenes)
heatmap(cooccur)
non_airport_scenes <- speaker_scene_matrix[, colSums(speaker_scene_matrix)<10]
cooccur <- non_airport_scenes %*% t(non_airport_scenes)
heatmap(cooccur)
non_airport_scenes <- speaker_scene_matrix[, colSums(speaker_scene_matrix)<13]
cooccur <- non_airport_scenes %*% t(non_airport_scenes)
heatmap(cooccur)
non_airport_scenes <- speaker_scene_matrix[, colSums(speaker_scene_matrix)<12]
cooccur <- non_airport_scenes %*% t(non_airport_scenes)
heatmap(cooccur)
non_airport_scenes <- speaker_scene_matrix[, colSums(speaker_scene_matrix)<13]
cooccur <- non_airport_scenes %*% t(non_airport_scenes)
heatmap(cooccur)
non_airport_scenes <- speaker_scene_matrix[, colSums(speaker_scene_matrix)<15]
cooccur <- non_airport_scenes %*% t(non_airport_scenes)
heatmap(cooccur)
non_airport_scenes <- speaker_scene_matrix[, colSums(speaker_scene_matrix)<15]
cooccur <- non_airport_scenes %*% t(non_airport_scenes)
heatmap(cooccur)
non_airport_scenes <- speaker_scene_matrix[, colSums(speaker_scene_matrix)<14]
cooccur <- non_airport_scenes %*% t(non_airport_scenes)
heatmap(cooccur)
non_airport_scenes <- speaker_scene_matrix[, colSums(speaker_scene_matrix)<13]
cooccur <- non_airport_scenes %*% t(non_airport_scenes)
heatmap(cooccur)
